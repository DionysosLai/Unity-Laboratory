# 版本更新

20210309

​		假设 上次是 3.9.2.228，那这次更新到4.0.0，需要写成4.0.0.300

## 1. 测试阶段

​		先将蓝盾ios 和 android 数据配置好，配置成4.0.0.230，例如如下所示：

![image-20210309191926207](https://raw.githubusercontent.com/DionysosLai/PicGoImage/main/image-20210309191926207.png)

## 2. 中转服

​		中转服，记得是realse 版本。android 包等测试说没问题之后，点击审核，发送到cdn。

### 2.1 修改资源线

​		1. 跟terry 确认好，将要采用哪条资源线，比方用3号线，那需要先配置好资源线，并且**立马生效-->强制加锁-->发布**，如下所示：

![image-20210309193051716](https://raw.githubusercontent.com/DionysosLai/PicGoImage/main/image-20210309193051716.png)

		2. 同时，需要将原来3号线配置的资源更新全部删除，并且**立马生效-->强制加锁-->发布**。

### 2.2 生成差异包

  1. 生成差异包时，需要好差异的包内容，如下所示：

     ![image-20210309193543966 ](https://raw.githubusercontent.com/DionysosLai/PicGoImage/main/image-20210309193543966.png![image-20210309193623033](https://raw.githubusercontent.com/DionysosLai/PicGoImage/main/image-20210309193623033.png)

     

     差异包出好之后，会自动上传到cdn。我们只需要一个json文件

### 2.3 配置中转服

​		配置中转服服，跟资源配置一样。在安装版本中，进行配置即可。

![image-20210309194340847](https://raw.githubusercontent.com/DionysosLai/PicGoImage/main/image-20210309194340847.png)

	### 2.4 灰度服

​		当中转服测试完成之后，后台后面会进行灰度服更新。之后等terry 通知灰度服配置即可。主要：

1. 需要问清楚灰度服的是哪几个服；
2. 右键灰度之后，需要将：检测到新版本 V4.0.0 -AllChannels|NeedDownSize ---> 检测到灰度新版本 V4.0.0 -AllChannels|NeedDownSize
3. 然后**立即生效**
4. 目录编辑界面，同时需要将几个服变成体验服标志
5. 最后，进行**强制加锁-->发布**

到此完成整个发布。